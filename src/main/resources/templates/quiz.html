<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" th:href="@{/css/quiz.css}">
	<title>Quiz Page</title>
</head>
<body>

	<!-- Importing NavBar -->
	<div th:insert="navbar.html :: navbar"></div>
	
	<div class="container py-5 px-4">
		<h1 class="bg-danger text-light">Choose The Correct Answers</h1>
		
		<form action="submit" method="POST" th:object="${qForm}">
			<!-- Timer display -->
			<div id="timer" class="mb-3 text-warning fs-5 fw-bold">Time Left: 05:00</div>

			<div class="ques-box bg-primary text-white p-3 mb-3" th:each="ques, i: ${qForm.questions}">
				<p class="title text-white fw-bold mb-3" th:text="${ques.title}"></p>
				
				<div class="option mb-2">
				  <label class="d-flex align-items-center gap-2" style="cursor:pointer;">
				    <input type="radio" th:name="|questions[${i.index}].chose|" th:value="1" />
				    <span th:text="${ques.optionA}"></span>
				  </label>
				</div>
				
				<div class="option mb-2">
				  <label class="d-flex align-items-center gap-2" style="cursor:pointer;">
				    <input type="radio" th:name="|questions[${i.index}].chose|" th:value="2" />
				    <span th:text="${ques.optionB}"></span>
				  </label>
				</div>
				
				<div class="option mb-2">
				  <label class="d-flex align-items-center gap-2" style="cursor:pointer;">
				    <input type="radio" th:name="|questions[${i.index}].chose|" th:value="3" />
				    <span th:text="${ques.optionC}"></span>
				  </label>
				</div>
				
				<input type="hidden" th:name="|questions[${i.index}].quesId|" th:value="${ques.quesId}" />
				<input type="hidden" th:name="|questions[${i.index}].title|" th:value="${ques.title}" />
				<input type="hidden" th:name="|questions[${i.index}].ans|" th:value="${ques.ans}" />
			</div>
			
			<button type="submit" class="btn btn-danger d-block mx-auto mt-4">Submit Answer</button>
		</form>
	</div>

	<!-- Importing Footer -->
	<div th:insert="footer.html :: footer"></div>
	
	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"></script>
	
	<!-- Timer Script -->
	<script>
	  const totalTime = 300; // total seconds = 5 minutes
	  let timeLeft = totalTime;

	  const timerDisplay = document.getElementById('timer');
	  const form = document.querySelector('form');

	  function updateTimer() {
	    const minutes = Math.floor(timeLeft / 60);
	    const seconds = timeLeft % 60;
	    timerDisplay.textContent = `Time Left: ${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;

	    if(timeLeft === 0) {
	      alert('Time is up! Submitting your answers.');
	      form.submit();
	    }
	    timeLeft--;
	  }

	  updateTimer(); // initial display
	  setInterval(updateTimer, 1000);
	</script>
</body>
</html>
